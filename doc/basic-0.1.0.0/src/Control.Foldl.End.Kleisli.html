<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Foldl.End.Kleisli</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Profunctor</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Profunctor</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Arrow</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Kleisli</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arrow</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ArrowChoice</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ArrowApply</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ArrowLoop</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Category</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Category</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-special">)</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><a href="Control.Foldl.End.html"><span class="hs-identifier">Control.Foldl.End</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.End.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.End.html#foldE"><span class="hs-identifier hs-var">foldE</span></a><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Trans.Reader</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Reader</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ReaderT</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">withReaderT</span><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-comment">-- | The `Kleisli` arrow of `FoldE`.</span><span>
</span><a name="line-13"></a><span class="hs-comment">--</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- Take an argument and fold over the (fixed) input type until success.</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- To compost, pass the success-result to the next `KfoldE` and continue folding.</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- (Thus &quot;horizontal&quot; composition.)</span><span>
</span><a name="line-17"></a><span class="hs-comment">--</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- It's `Category` instance represents horizontal composition of `FoldE`'s.</span><span>
</span><a name="line-19"></a><span class="hs-keyword">newtype</span><span> </span><a name="KfoldE"><a href="Control.Foldl.End.Kleisli.html#KfoldE"><span class="hs-identifier">KfoldE</span></a></a><span> </span><a name="local-6989586621679113331"><a href="#local-6989586621679113331"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679113332"><a href="#local-6989586621679113332"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679113333"><a href="#local-6989586621679113333"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="KfoldE"><a href="Control.Foldl.End.Kleisli.html#KfoldE"><span class="hs-identifier">KfoldE</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unKfoldE"><a href="Control.Foldl.End.Kleisli.html#unKfoldE"><span class="hs-identifier">unKfoldE</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kleisli</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.End.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a><span> </span><a href="#local-6989586621679113331"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113332"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679113333"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Category</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arrow</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ArrowChoice</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ArrowApply</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ArrowLoop</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-identifier">kfoldEToReader</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.End.Kleisli.html#KfoldE"><span class="hs-identifier hs-type">KfoldE</span></a><span> </span><a href="#local-6989586621679113344"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679113345"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679113346"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ReaderT</span><span> </span><a href="#local-6989586621679113345"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.End.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a><span> </span><a href="#local-6989586621679113344"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113346"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-22"></a><a name="kfoldEToReader"><a href="Control.Foldl.End.Kleisli.html#kfoldEToReader"><span class="hs-identifier">kfoldEToReader</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-identifier">readerToKfoldE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ReaderT</span><span> </span><a href="#local-6989586621679113341"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.End.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a><span> </span><a href="#local-6989586621679113342"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679113343"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.End.Kleisli.html#KfoldE"><span class="hs-identifier hs-type">KfoldE</span></a><span> </span><a href="#local-6989586621679113342"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679113341"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679113343"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-25"></a><a name="readerToKfoldE"><a href="Control.Foldl.End.Kleisli.html#readerToKfoldE"><span class="hs-identifier">readerToKfoldE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-identifier">runKfoldE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.End.Kleisli.html#KfoldE"><span class="hs-identifier hs-type">KfoldE</span></a><span> </span><a href="#local-6989586621679113338"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679113339"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679113340"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679113339"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.End.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a><span> </span><a href="#local-6989586621679113338"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679113340"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-28"></a><a name="runKfoldE"><a href="Control.Foldl.End.Kleisli.html#runKfoldE"><span class="hs-identifier">runKfoldE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">runKleisli</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unKfoldE</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-identifier">kfoldE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679113334"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.End.Kleisli.html#KfoldE"><span class="hs-identifier hs-type">KfoldE</span></a><span> </span><a href="#local-6989586621679113335"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679113336"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679113337"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679113336"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679113334"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679113335"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679113337"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-31"></a><a name="kfoldE"><a href="Control.Foldl.End.Kleisli.html#kfoldE"><span class="hs-identifier">kfoldE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Control.Foldl.End.html#foldE"><span class="hs-identifier hs-var">foldE</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">runKleisli</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unKfoldE</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-comment">-- Consider the type signature of `foldEThenE`:</span><span>
</span><a name="line-34"></a><span class="hs-comment">--</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-36"></a><span class="hs-comment">--  foldEThenE :: FoldE a b -&gt; (b -&gt; FoldE a c) -&gt; FoldE a c</span><span>
</span><a name="line-37"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-38"></a><span class="hs-comment">--</span><span>
</span><a name="line-39"></a><span class="hs-comment">-- One might think that we could get horizontal composition out of</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- a suitable rearrangement:</span><span>
</span><a name="line-41"></a><span class="hs-comment">--</span><span>
</span><a name="line-42"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-43"></a><span class="hs-comment">--  flip . (foldEThenE .) :: (b -&gt; FoldE a c) -&gt; (c -&gt; FoldE a d) -&gt; (b -&gt; FoldE a d)</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-45"></a><span class="hs-comment">--</span><span>
</span><a name="line-46"></a><span class="hs-comment">-- And that rearrangment gives rise to the following newtype:</span><span>
</span><a name="line-47"></a><span class="hs-comment">-- newtype AFoldE a b c = AFoldE { runAFoldE :: ReaderT b (FoldE a) c } deriving (Functor, Applicative, Monad, MonadFix, MonadZip)</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-comment">-- ^ This is just Kleisi (FoldE a) b c</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-comment">-- instance Profunctor (AFoldE a) where</span><span>
</span><a name="line-52"></a><span class="hs-comment">--   lmap f = AFoldE . withReaderT f . runAFoldE</span><span>
</span><a name="line-53"></a><span class="hs-comment">--   rmap f = AFoldE . fmap f . runAFoldE</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-comment">-- -- I believe that horizontal composition will distribute over vertical composition (in some way):</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- vertical   :: AFoldE b t c -&gt; AFoldE a t b -&gt; AFoldE a t c</span><span>
</span><a name="line-58"></a><span class="hs-comment">-- vertical = undefined</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">-- horizontal :: AFoldE t b c -&gt; AFoldE t a b -&gt; AFoldE t a c</span><span>
</span><a name="line-61"></a><span class="hs-comment">-- horizontal = undefined</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-comment">-- | Vertical</span><span>
</span><a name="line-64"></a><span class="hs-comment">--</span><span>
</span><a name="line-65"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-66"></a><span class="hs-comment">--   [1..4]</span><span>
</span><a name="line-67"></a><span class="hs-comment">--   &#955;&gt; foldE (takeE 2) [1..4]</span><span>
</span><a name="line-68"></a><span class="hs-comment">--   [1,2]</span><span>
</span><a name="line-69"></a><span class="hs-comment">--</span><span>
</span><a name="line-70"></a><span class="hs-comment">--   &#955;&gt; foldE (toFoldE F.list) [1..4]</span><span>
</span><a name="line-71"></a><span class="hs-comment">--   [1,2,3,4]</span><span>
</span><a name="line-72"></a><span class="hs-comment">--</span><span>
</span><a name="line-73"></a><span class="hs-comment">--   &#955;&gt; foldE (toFoldE F.list `o` takeE 3) [1..10]</span><span>
</span><a name="line-74"></a><span class="hs-comment">--   [[1,2],[3,4]]</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-76"></a><span class="hs-comment">--</span><span>
</span><a name="line-77"></a><span class="hs-comment">-- Vertical composition repeats the application of the first</span><span>
</span><a name="line-78"></a><span class="hs-comment">-- function, passing the intermediate results to the second function.</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- | Horizontal</span><span>
</span><a name="line-82"></a><span class="hs-comment">--</span><span>
</span><a name="line-83"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-84"></a><span class="hs-comment">--  [x, y, z, w]</span><span>
</span><a name="line-85"></a><span class="hs-comment">--  g . f</span><span>
</span><a name="line-86"></a><span class="hs-comment">--    f x y = Left f'</span><span>
</span><a name="line-87"></a><span class="hs-comment">--    g f' z w</span><span>
</span><a name="line-88"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-89"></a><span class="hs-comment">--</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- The first is folded over the input until it returns.</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- Then the second is initialized using its result and continues folding.</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- HFoldE a b c = Kleisi (FoldE a) b c</span><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-comment">-- | Linear</span><span>
</span><a name="line-95"></a><span class="hs-comment">--</span><span>
</span><a name="line-96"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-97"></a><span class="hs-comment">--  [x, y, z]</span><span>
</span><a name="line-98"></a><span class="hs-comment">--  h x y z (g x y z (f x y z))</span><span>
</span><a name="line-99"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-100"></a><span class="hs-comment">--</span><span>
</span><a name="line-101"></a><span class="hs-comment">-- All of the inputs and the output are fed into the continuation.</span><span>
</span><a name="line-102"></a><span class="hs-comment">-- This may not be very performant..</span><span>
</span><a name="line-103"></a><span class="hs-comment">-- LFoldE a b c = Cokleisi (FoldE a) b c</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- (f `horizontal` g) `vertical` h :: AFoldE a t c</span><span>
</span><a name="line-107"></a><span class="hs-comment">--   f :: AFoldE d t c</span><span>
</span><a name="line-108"></a><span class="hs-comment">--   g :: AFoldE b t d</span><span>
</span><a name="line-109"></a><span class="hs-comment">--   f `horizontal` g :: AFoldE b t c</span><span>
</span><a name="line-110"></a><span class="hs-comment">--   h :: AFoldE a t b</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-comment">-- f `vertical` (g `horizontal` h) :: AFoldE a t c</span><span>
</span><a name="line-113"></a><span class="hs-comment">--   f :: AFoldE b t c</span><span>
</span><a name="line-114"></a><span class="hs-comment">--   g :: AFoldE a d b</span><span>
</span><a name="line-115"></a><span class="hs-comment">--   h :: AFoldE a t d</span><span>
</span><a name="line-116"></a><span class="hs-comment">--   g `horizontal` h :: AFoldE a t b</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">-- (f `vertical` g) `horizontal` h :: AFoldE t a c</span><span>
</span><a name="line-119"></a><span class="hs-comment">--   f :: AFoldE d b c</span><span>
</span><a name="line-120"></a><span class="hs-comment">--   g :: AFoldE t b d</span><span>
</span><a name="line-121"></a><span class="hs-comment">--   f `vertical` g :: t b c</span><span>
</span><a name="line-122"></a><span class="hs-comment">--   h :: AFoldE t a b</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-comment">-- f `horizontal` (g `vertical` h) :: AFoldE t a c</span><span>
</span><a name="line-125"></a><span class="hs-comment">--   f :: AFoldE t b c</span><span>
</span><a name="line-126"></a><span class="hs-comment">--   g :: AFoldE d a b</span><span>
</span><a name="line-127"></a><span class="hs-comment">--   h :: AFoldE t a d</span><span>
</span><a name="line-128"></a><span class="hs-comment">--   g `vertical` h :: AFoldE t a b</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">-- tt1 :: AFoldE b1 b2 c -&gt; AFoldE b1 t b2 -&gt; AFoldE a t b1 -&gt; AFoldE a t c</span><span>
</span><a name="line-132"></a><span class="hs-comment">-- tt1 = \f g h -&gt; (f `horizontal` g) `vertical` h</span><span>
</span><a name="line-133"></a><span>  </span><span class="hs-comment">-- f `horizontal` g :: AFoldE b1 t c</span><span>
</span><a name="line-134"></a><span>  </span><span class="hs-comment">-- f1 `horizontal` g1 :: AFoldE b1 t c</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- tt3 :: AFoldE b1 b2 c -&gt; AFoldE a b2 b1 -&gt; AFoldE a t b2 -&gt; AFoldE a t c</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- tt3 = \f g h -&gt; (f `vertical` g) `horizontal` h</span><span>
</span><a name="line-138"></a><span>  </span><span class="hs-comment">-- f `vertical` g :: AFoldE a b2 c</span><span>
</span><a name="line-139"></a><span>  </span><span class="hs-comment">-- f2 `vertical` g2 :: AFoldE a b2 c</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-comment">-- tt2 :: AFoldE b2 t c -&gt; AFoldE a b1 b2 -&gt; AFoldE a t b1 -&gt; AFoldE a t c</span><span>
</span><a name="line-142"></a><span class="hs-comment">-- tt2 = \f g h -&gt; f `vertical` (g `horizontal` h) -- :: AFoldE a t b2</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">-- (f2 `vertical` g2) `horizontal` g2 :: AFoldE a b1 c</span><span>
</span><a name="line-145"></a><span class="hs-comment">-- (f2 `vertical` g2) `horizontal` g2 `horizontal` h1:: AFoldE a t c</span><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span class="hs-comment">-- tt4 :: AFoldE a b1 c -&gt; AFoldE b2 t b1 -&gt; AFoldE a t b2 -&gt; AFoldE a t c</span><span>
</span><a name="line-148"></a><span class="hs-comment">-- tt4 = \f g h -&gt; f `horizontal` (g `vertical` h) -- :: AFoldE a t b1</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-comment">-- (f1 `horizontal` g1) `vertical` g4 :: AFoldE b1 t c</span><span>
</span><a name="line-151"></a><span class="hs-comment">-- (f1 `horizontal` g1) `vertical` g4 `vertical` h1 :: AFoldE a t c</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">-- tt1' :: AFoldE b1 b2 c -&gt; AFoldE b1 t b2 -&gt; AFoldE a t b1 -&gt; (AFoldE a t c, AFoldE a t b2)</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- tt1' = \f g h -&gt; ((f `horizontal` g) `vertical` h, g `vertical` h)</span><span>
</span><a name="line-155"></a><span>  </span><span class="hs-comment">-- f `horizontal` g :: AFoldE b1 t c</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">-- tt3' :: AFoldE b1 b2 c -&gt; AFoldE a b2 b1 -&gt; AFoldE a t b2 -&gt; (AFoldE a t c, AFoldE a t b1)</span><span>
</span><a name="line-158"></a><span class="hs-comment">-- tt3' = \f g h -&gt; ((f `vertical` g) `horizontal` h, g `horizontal` h)</span><span>
</span><a name="line-159"></a><span>  </span><span class="hs-comment">-- f `vertical` g :: AFoldE a b2 c</span><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span class="hs-comment">-- tt2_ = \f g h i -&gt; tt2 f g (h `horizontal` i)</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">-- tt4_ = \f g h i -&gt; tt4 f g (h `vertical` i)</span><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span class="hs-comment">-- tt1' = tt1' f g</span><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-comment">-- 8 ways to get to a t c?</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-comment">-- tt1, tt2, tt3, tt4</span><span>
</span><a name="line-170"></a><span class="hs-comment">-- tt1 f g (h `horizontal` i)</span><span>
</span><a name="line-171"></a><span class="hs-comment">-- tt2 f g (h `horizontal` i)</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- tt3 f g (h `horizontal` i)</span><span>
</span><a name="line-173"></a><span class="hs-comment">-- tt4 f g (h `horizontal` i)</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a></pre></body></html>