<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Copyright  :  (C) 2015-2016, University of Twente,
                  2017     , QBayLogic B.V.
License    :  BSD2 (see the file LICENSE)
Maintainer :  Christiaan Baaij &lt;christiaan.baaij@gmail.com&gt;

A type checker plugin for GHC that can solve /equalities/ of types of kind
'GHC.TypeLits.Nat', where these types are either:

* Type-level naturals
* Type variables
* Applications of the arithmetic expressions @(+,-,*,^)@.

It solves these equalities by normalising them to /sort-of/
'GHC.TypeLits.Normalise.SOP.SOP' (Sum-of-Products) form, and then perform a
simple syntactic equality.

For example, this solver can prove the equality between:

@
(x + 2)^(y + 2)
@

and

@
4*x*(2 + x)^y + 4*(2 + x)^y + (2 + x)^y*x^2
@

Because the latter is actually the 'GHC.TypeLits.Normalise.SOP.SOP' normal form
of the former.

To use the plugin, add

@
{\-\# OPTIONS_GHC -fplugin GHC.TypeLits.Normalise \#-\}
@

To the header of your file.

== Treating subtraction as addition with a negated number

If you are absolutely sure that your subtractions can /never/ lead to (a locally)
negative number, you can ask the plugin to treat subtraction as addition with
a negated operand by additionally adding:

@
{\-\# OPTIONS_GHC -fplugin-opt GHC.TypeLits.Normalise:allow-negated-numbers \#-\}
@

to the header of your file, thereby allowing to use associativity and
commutativity rules when proving constraints involving subtractions. Note that
this option can lead to unsound behaviour and should be handled with extreme
care.

=== When it leads to unsound behaviour

For example, enabling the /allow-negated-numbers/ feature would allow
you to prove:

@
(n - 1) + 1 ~ n
@

/without/ a @(1 &lt;= n)@ constraint, even though when /n/ is set to /0/ the
subtraction @n-1@ would be locally negative and hence not be a natural number.

This would allow the following erroneous definition:

@
data Fin (n :: Nat) where
  FZ :: Fin (n + 1)
  FS :: Fin n -&gt; Fin (n + 1)

f :: forall n . Natural -&gt; Fin n
f n = case of
  0 -&gt; FZ
  x -&gt; FS (f \@(n-1) (x - 1))

fs :: [Fin 0]
fs = f \&lt;$\&gt; [0..]
@

=== When it might be Okay

This example is taken from the &lt;http://hackage.haskell.org/package/mezzo mezzo&gt;
library.

When you have:

@
-- | Singleton type for the number of repetitions of an element.
data Times (n :: Nat) where
    T :: Times n

-- | An element of a &quot;run-length encoded&quot; vector, containing the value and
-- the number of repetitions
data Elem :: Type -&gt; Nat -&gt; Type where
    (:*) :: t -&gt; Times n -&gt; Elem t n

-- | A length-indexed vector, optimised for repetitions.
data OptVector :: Type -&gt; Nat -&gt; Type where
    End  :: OptVector t 0
    (:-) :: Elem t l -&gt; OptVector t (n - l) -&gt; OptVector t n
@

And you want to define:

@
-- | Append two optimised vectors.
type family (x :: OptVector t n) ++ (y :: OptVector t m) :: OptVector t (n + m) where
    ys        ++ End = ys
    End       ++ ys = ys
    (x :- xs) ++ ys = x :- (xs ++ ys)
@

then the last line will give rise to the constraint:

@
(n-l)+m ~ (n+m)-l
@

because:

@
x  :: Elem t l
xs :: OptVector t (n-l)
ys :: OptVector t m
@

In this case it's okay to add

@
{\-\# OPTIONS_GHC -fplugin-opt GHC.TypeLits.Normalise:allow-negated-numbers \#-\}
@

if you can convince yourself you will never be able to construct a:

@
xs :: OptVector t (n-l)
@

where /n-l/ is a negative number.
-}</span><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-pragma">{-# LANGUAGE CPP             #-}</span><span>
</span><a name="line-147"></a><span class="hs-pragma">{-# LANGUAGE LambdaCase      #-}</span><span>
</span><a name="line-148"></a><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><a name="line-149"></a><span class="hs-pragma">{-# LANGUAGE TupleSections   #-}</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-pragma">{-# OPTIONS_HADDOCK show-extensions #-}</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.TypeLits.Normalise</span><span>
</span><a name="line-154"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="GHC.TypeLits.Normalise.html#plugin"><span class="hs-identifier hs-var">plugin</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-155"></a><span class="hs-keyword">where</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">-- external</span><span>
</span><a name="line-158"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Arrow</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">second</span><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicateM</span><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Trans.Writer.Strict</span><span>
</span><a name="line-161"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Either</span><span>         </span><span class="hs-special">(</span><span class="hs-identifier hs-var">rights</span><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intersect</span><span class="hs-special">)</span><span>
</span><a name="line-163"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.TcPluginM.Extra</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tracePlugin</span><span class="hs-special">)</span><span>
</span><a name="line-165"></a><span class="hs-cpp">#if MIN_VERSION_ghc(8,4,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.TcPluginM.Extra</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flattenGivens</span><span class="hs-special">)</span><span>
</span><a name="line-167"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-169"></a><span class="hs-comment">-- GHC API</span><span>
</span><a name="line-170"></a><span class="hs-cpp">#if MIN_VERSION_ghc(8,5,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">CoreSyn</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">Expr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-172"></a><span class="hs-cpp">#endif
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Outputable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Outputable</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;+&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">$$</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">text</span><span class="hs-special">)</span><span>
</span><a name="line-174"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Plugins</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Plugin</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">defaultPlugin</span><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcEvidence</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">EvTerm</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-176"></a><span class="hs-cpp">#if !MIN_VERSION_ghc(8,4,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcPluginM</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">zonkCt</span><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span class="hs-cpp">#endif
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcPluginM</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TcPluginM</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">tcPluginTrace</span><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcRnTypes</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ct</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TcPlugin</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TcPluginResult</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">ctEvidence</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">ctEvPred</span><span class="hs-special">,</span><span>
</span><a name="line-181"></a><span>                   </span><span class="hs-identifier hs-var">isWanted</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkNonCanonical</span><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Type</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">EqRel</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NomEq</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Kind</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PredTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">EqPred</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PredType</span><span class="hs-special">,</span><span>
</span><a name="line-183"></a><span>                   </span><span class="hs-identifier hs-var">classifyPredType</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">eqType</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">getEqPredTys</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkTyVarTy</span><span class="hs-special">)</span><span>
</span><a name="line-184"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TysWiredIn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeNatKind</span><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Coercion</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CoercionHole</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Role</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkForAllCos</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkHoleCo</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkInstCo</span><span class="hs-special">,</span><span>
</span><a name="line-187"></a><span>                   </span><span class="hs-identifier hs-var">mkNomReflCo</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkUnivCo</span><span class="hs-special">)</span><span>
</span><a name="line-188"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcPluginM</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">newCoercionHole</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">newFlexiTyVar</span><span class="hs-special">)</span><span>
</span><a name="line-189"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcRnTypes</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CtEvidence</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CtLoc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TcEvDest</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">ctLoc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isGiven</span><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span class="hs-cpp">#if MIN_VERSION_ghc(8,2,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcRnTypes</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ShadowInfo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">WDeriv</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-192"></a><span class="hs-cpp">#endif
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TyCoRep</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">UnivCoProvenance</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-194"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Type</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkPrimEqPred</span><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcType</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeKind</span><span class="hs-special">)</span><span>
</span><a name="line-196"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TyCoRep</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcTypeNats</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeNatAddTyCon</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeNatExpTyCon</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeNatMulTyCon</span><span class="hs-special">,</span><span>
</span><a name="line-198"></a><span>                   </span><span class="hs-identifier hs-var">typeNatSubTyCon</span><span class="hs-special">)</span><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcTypeNats</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeNatLeqTyCon</span><span class="hs-special">)</span><span>
</span><a name="line-201"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TysWiredIn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">promotedFalseDataCon</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">promotedTrueDataCon</span><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-comment">-- internal</span><span>
</span><a name="line-204"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.TypeLits.Normalise.Unify.html"><span class="hs-identifier">GHC.TypeLits.Normalise.Unify</span></a><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-comment">-- | To use the plugin, add</span><span>
</span><a name="line-207"></a><span class="hs-comment">--</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-209"></a><span class="hs-comment">-- {\-\# OPTIONS_GHC -fplugin GHC.TypeLits.Normalise \#-\}</span><span>
</span><a name="line-210"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-211"></a><span class="hs-comment">--</span><span>
</span><a name="line-212"></a><span class="hs-comment">-- To the header of your file.</span><span>
</span><a name="line-213"></a><span class="hs-identifier">plugin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Plugin</span><span>
</span><a name="line-214"></a><a name="plugin"><a href="GHC.TypeLits.Normalise.html#plugin"><span class="hs-identifier">plugin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">defaultPlugin</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcPlugin</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679091379"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-215"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-216"></a><span>  </span><a name="local-6989586621679091379"><a href="#local-6989586621679091379"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;allow-negated-numbers&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.html#normalisePlugin"><span class="hs-identifier hs-var">normalisePlugin</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span>  </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.html#normalisePlugin"><span class="hs-identifier hs-var">normalisePlugin</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-identifier">normalisePlugin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TcPlugin</span><span>
</span><a name="line-220"></a><a name="normalisePlugin"><a href="GHC.TypeLits.Normalise.html#normalisePlugin"><span class="hs-identifier">normalisePlugin</span></a></a><span> </span><a name="local-6989586621679091380"><a href="#local-6989586621679091380"><span class="hs-identifier">negNumbers</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tracePlugin</span><span> </span><span class="hs-string">&quot;ghc-typelits-natnormalise&quot;</span><span>
</span><a name="line-221"></a><span>  </span><span class="hs-identifier hs-var">TcPlugin</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcPluginInit</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcPluginSolve</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.html#decideEqualSOP"><span class="hs-identifier hs-var">decideEqualSOP</span></a><span> </span><a href="#local-6989586621679091380"><span class="hs-identifier hs-var">negNumbers</span></a><span class="hs-special">)</span><span>
</span><a name="line-223"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcPluginStop</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>           </span><span class="hs-special">}</span><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-identifier">decideEqualSOP</span><span>
</span><a name="line-227"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-228"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Ct</span><span class="hs-special">]</span><span>
</span><a name="line-229"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Ct</span><span class="hs-special">]</span><span>
</span><a name="line-230"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Ct</span><span class="hs-special">]</span><span>
</span><a name="line-231"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TcPluginM</span><span> </span><span class="hs-identifier hs-type">TcPluginResult</span><span>
</span><a name="line-232"></a><a name="decideEqualSOP"><a href="GHC.TypeLits.Normalise.html#decideEqualSOP"><span class="hs-identifier">decideEqualSOP</span></a></a><span> </span><a name="local-6989586621679091381"><a href="#local-6989586621679091381"><span class="hs-identifier">_negNumbers</span></a></a><span> </span><a name="local-6989586621679091382"><a href="#local-6989586621679091382"><span class="hs-identifier">_givens</span></a></a><span> </span><a name="local-6989586621679091383"><a href="#local-6989586621679091383"><span class="hs-identifier">_deriveds</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TcPluginOk</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-233"></a><span class="hs-identifier">decideEqualSOP</span><span> </span><a name="local-6989586621679091384"><a href="#local-6989586621679091384"><span class="hs-identifier">negNumbers</span></a></a><span>  </span><a name="local-6989586621679091385"><a href="#local-6989586621679091385"><span class="hs-identifier">givens</span></a></a><span>  </span><a name="local-6989586621679091386"><a href="#local-6989586621679091386"><span class="hs-identifier">_deriveds</span></a></a><span> </span><a name="local-6989586621679091387"><a href="#local-6989586621679091387"><span class="hs-identifier">wanteds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-234"></a><span>    </span><span class="hs-comment">-- GHC 7.10.1 puts deriveds with the wanteds, so filter them out</span><span>
</span><a name="line-235"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679091388"><a href="#local-6989586621679091388"><span class="hs-identifier">wanteds'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isWanted</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">ctEvidence</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679091387"><span class="hs-identifier hs-var">wanteds</span></a><span>
</span><a name="line-236"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679091389"><a href="#local-6989586621679091389"><span class="hs-identifier">unit_wanteds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapMaybe</span><span> </span><a href="GHC.TypeLits.Normalise.html#toNatEquality"><span class="hs-identifier hs-var">toNatEquality</span></a><span> </span><a href="#local-6989586621679091388"><span class="hs-identifier hs-var">wanteds'</span></a><span>
</span><a name="line-237"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679091389"><span class="hs-identifier hs-var">unit_wanteds</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-238"></a><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TcPluginOk</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-239"></a><span>      </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-240"></a><span class="hs-cpp">#if MIN_VERSION_ghc(8,4,0)
</span><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679091390"><a href="#local-6989586621679091390"><span class="hs-identifier">unit_givens</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapMaybe</span><span> </span><a href="GHC.TypeLits.Normalise.html#toNatEquality"><span class="hs-identifier hs-var">toNatEquality</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091385"><span class="hs-identifier hs-var">givens</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">flattenGivens</span><span> </span><a href="#local-6989586621679091385"><span class="hs-identifier hs-var">givens</span></a><span class="hs-special">)</span><span>
</span><a name="line-242"></a><span class="hs-cpp">#else
</span><span>        </span><span class="hs-identifier">unit_givens</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">mapMaybe</span><span> </span><span class="hs-identifier">toNatEquality</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">zonkCt</span><span> </span><span class="hs-identifier">givens</span><span>
</span><a name="line-244"></a><span class="hs-cpp">#endif
</span><span>        </span><a name="local-6989586621679091391"><a href="#local-6989586621679091391"><span class="hs-identifier">sr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="GHC.TypeLits.Normalise.html#simplifyNats"><span class="hs-identifier hs-var">simplifyNats</span></a><span> </span><a href="#local-6989586621679091384"><span class="hs-identifier hs-var">negNumbers</span></a><span> </span><a href="#local-6989586621679091390"><span class="hs-identifier hs-var">unit_givens</span></a><span> </span><a href="#local-6989586621679091389"><span class="hs-identifier hs-var">unit_wanteds</span></a><span>
</span><a name="line-246"></a><span>        </span><span class="hs-identifier hs-var">tcPluginTrace</span><span> </span><span class="hs-string">&quot;normalised&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621679091391"><span class="hs-identifier hs-var">sr</span></a><span class="hs-special">)</span><span>
</span><a name="line-247"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679091391"><span class="hs-identifier hs-var">sr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-248"></a><span>          </span><a href="GHC.TypeLits.Normalise.html#Simplified"><span class="hs-identifier hs-var">Simplified</span></a><span> </span><a name="local-6989586621679091392"><a href="#local-6989586621679091392"><span class="hs-identifier">evs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-249"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679091393"><a href="#local-6989586621679091393"><span class="hs-identifier">solved</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isWanted</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">ctEvidence</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679091396"><a href="#local-6989586621679091396"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679091396"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679091392"><span class="hs-identifier hs-var">evs</span></a><span>
</span><a name="line-250"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679091394"><a href="#local-6989586621679091394"><span class="hs-identifier">solved'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091395"><a href="#local-6989586621679091395"><span class="hs-identifier">newWanteds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">second</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unzip</span><span> </span><a href="#local-6989586621679091393"><span class="hs-identifier hs-var">solved</span></a><span class="hs-special">)</span><span>
</span><a name="line-251"></a><span>            </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TcPluginOk</span><span> </span><a href="#local-6989586621679091394"><span class="hs-identifier hs-var">solved'</span></a><span> </span><a href="#local-6989586621679091395"><span class="hs-identifier hs-var">newWanteds</span></a><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span>          </span><a href="GHC.TypeLits.Normalise.html#Impossible"><span class="hs-identifier hs-var">Impossible</span></a><span> </span><a name="local-6989586621679091397"><a href="#local-6989586621679091397"><span class="hs-identifier">eq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TcPluginContradiction</span><span> </span><span class="hs-special">[</span><a href="GHC.TypeLits.Normalise.html#fromNatEquality"><span class="hs-identifier hs-var">fromNatEquality</span></a><span> </span><a href="#local-6989586621679091397"><span class="hs-identifier hs-var">eq</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span class="hs-keyword">type</span><span> </span><a name="NatEquality"><a href="GHC.TypeLits.Normalise.html#NatEquality"><span class="hs-identifier">NatEquality</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ct</span><span class="hs-special">,</span><a href="GHC.TypeLits.Normalise.Unify.html#CoreSOP"><span class="hs-identifier hs-type">CoreSOP</span></a><span class="hs-special">,</span><a href="GHC.TypeLits.Normalise.Unify.html#CoreSOP"><span class="hs-identifier hs-type">CoreSOP</span></a><span class="hs-special">)</span><span>
</span><a name="line-255"></a><span class="hs-keyword">type</span><span> </span><a name="NatInEquality"><a href="GHC.TypeLits.Normalise.html#NatInEquality"><span class="hs-identifier">NatInEquality</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ct</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.Unify.html#CoreSOP"><span class="hs-identifier hs-type">CoreSOP</span></a><span class="hs-special">,</span><a href="GHC.TypeLits.Normalise.Unify.html#CoreSOP"><span class="hs-identifier hs-type">CoreSOP</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-256"></a><span>
</span><a name="line-257"></a><span class="hs-identifier">fromNatEquality</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="GHC.TypeLits.Normalise.html#NatEquality"><span class="hs-identifier hs-type">NatEquality</span></a><span> </span><a href="GHC.TypeLits.Normalise.html#NatInEquality"><span class="hs-identifier hs-type">NatInEquality</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ct</span><span>
</span><a name="line-258"></a><a name="fromNatEquality"><a href="GHC.TypeLits.Normalise.html#fromNatEquality"><span class="hs-identifier">fromNatEquality</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span>  </span><span class="hs-special">(</span><a name="local-6989586621679091398"><a href="#local-6989586621679091398"><span class="hs-identifier">ct</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679091398"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-259"></a><span class="hs-identifier">fromNatEquality</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679091399"><a href="#local-6989586621679091399"><span class="hs-identifier">ct</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679091399"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-keyword">data</span><span> </span><a name="SimplifyResult"><a href="GHC.TypeLits.Normalise.html#SimplifyResult"><span class="hs-identifier">SimplifyResult</span></a></a><span>
</span><a name="line-262"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Simplified"><a href="GHC.TypeLits.Normalise.html#Simplified"><span class="hs-identifier">Simplified</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-type">EvTerm</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ct</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Ct</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-263"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Impossible"><a href="GHC.TypeLits.Normalise.html#Impossible"><span class="hs-identifier">Impossible</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="GHC.TypeLits.Normalise.html#NatEquality"><span class="hs-identifier hs-type">NatEquality</span></a><span> </span><a href="GHC.TypeLits.Normalise.html#NatInEquality"><span class="hs-identifier hs-type">NatInEquality</span></a><span class="hs-special">)</span><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Outputable</span><span> </span><a href="GHC.TypeLits.Normalise.html#SimplifyResult"><span class="hs-identifier hs-type">SimplifyResult</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-266"></a><span>  </span><a name="local-8214565720323812202"><span class="hs-identifier">ppr</span></a><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.html#Simplified"><span class="hs-identifier hs-var">Simplified</span></a><span> </span><a name="local-6989586621679091377"><a href="#local-6989586621679091377"><span class="hs-identifier">evs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Simplified&quot;</span><span> </span><span class="hs-operator hs-var">$$</span><span> </span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621679091377"><span class="hs-identifier hs-var">evs</span></a><span>
</span><a name="line-267"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.html#Impossible"><span class="hs-identifier hs-var">Impossible</span></a><span> </span><a name="local-6989586621679091378"><a href="#local-6989586621679091378"><span class="hs-identifier">eq</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">text</span><span> </span><span class="hs-string">&quot;Impossible&quot;</span><span> </span><span class="hs-operator hs-var">&lt;+&gt;</span><span> </span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621679091378"><span class="hs-identifier hs-var">eq</span></a><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-identifier">simplifyNats</span><span>
</span><a name="line-270"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-271"></a><span>  </span><span class="hs-comment">-- ^ Allow negated numbers (potentially unsound!)</span><span>
</span><a name="line-272"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="GHC.TypeLits.Normalise.html#NatEquality"><span class="hs-identifier hs-type">NatEquality</span></a><span> </span><a href="GHC.TypeLits.Normalise.html#NatInEquality"><span class="hs-identifier hs-type">NatInEquality</span></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-273"></a><span>  </span><span class="hs-comment">-- ^ Given constraints</span><span>
</span><a name="line-274"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="GHC.TypeLits.Normalise.html#NatEquality"><span class="hs-identifier hs-type">NatEquality</span></a><span> </span><a href="GHC.TypeLits.Normalise.html#NatInEquality"><span class="hs-identifier hs-type">NatInEquality</span></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-275"></a><span>  </span><span class="hs-comment">-- ^ Wanted constraints</span><span>
</span><a name="line-276"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TcPluginM</span><span> </span><a href="GHC.TypeLits.Normalise.html#SimplifyResult"><span class="hs-identifier hs-type">SimplifyResult</span></a><span>
</span><a name="line-277"></a><a name="simplifyNats"><a href="GHC.TypeLits.Normalise.html#simplifyNats"><span class="hs-identifier">simplifyNats</span></a></a><span> </span><a name="local-6989586621679091400"><a href="#local-6989586621679091400"><span class="hs-identifier">negNumbers</span></a></a><span> </span><a name="local-6989586621679091401"><a href="#local-6989586621679091401"><span class="hs-identifier">eqsG</span></a></a><span> </span><a name="local-6989586621679091402"><a href="#local-6989586621679091402"><span class="hs-identifier">eqsW</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-278"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679091454"><a href="#local-6989586621679091454"><span class="hs-identifier">eqs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">second</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679091401"><span class="hs-identifier hs-var">eqsG</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679091402"><span class="hs-identifier hs-var">eqsW</span></a><span>
</span><a name="line-279"></a><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-identifier hs-var">tcPluginTrace</span><span> </span><span class="hs-string">&quot;simplifyNats&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621679091454"><span class="hs-identifier hs-var">eqs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-6989586621679091404"><span class="hs-identifier hs-var">simples</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679091454"><span class="hs-identifier hs-var">eqs</span></a><span>
</span><a name="line-280"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-281"></a><span>    </span><span class="hs-comment">-- If we allow negated numbers we simply do not emit the inequalities</span><span>
</span><a name="line-282"></a><span>    </span><span class="hs-comment">-- derived from the subtractions that are converted to additions with a</span><span>
</span><a name="line-283"></a><span>    </span><span class="hs-comment">-- negated operand</span><span>
</span><a name="line-284"></a><span>    </span><a name="local-6989586621679091403"><a href="#local-6989586621679091403"><span class="hs-identifier">subToPred</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679091400"><span class="hs-identifier hs-var">negNumbers</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-285"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="GHC.TypeLits.Normalise.Unify.html#subtractionToPred"><span class="hs-identifier hs-var">subtractionToPred</span></a><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span>    </span><span class="hs-identifier">simples</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="GHC.TypeLits.Normalise.Unify.html#CoreUnify"><span class="hs-identifier hs-type">CoreUnify</span></a><span class="hs-special">]</span><span>
</span><a name="line-288"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-type">EvTerm</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ct</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Ct</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-289"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.Unify.html#CoreSOP"><span class="hs-identifier hs-type">CoreSOP</span></a><span class="hs-special">,</span><a href="GHC.TypeLits.Normalise.Unify.html#CoreSOP"><span class="hs-identifier hs-type">CoreSOP</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-290"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="GHC.TypeLits.Normalise.html#NatEquality"><span class="hs-identifier hs-type">NatEquality</span></a><span> </span><a href="GHC.TypeLits.Normalise.html#NatInEquality"><span class="hs-identifier hs-type">NatInEquality</span></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-291"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="GHC.TypeLits.Normalise.html#NatEquality"><span class="hs-identifier hs-type">NatEquality</span></a><span> </span><a href="GHC.TypeLits.Normalise.html#NatInEquality"><span class="hs-identifier hs-type">NatInEquality</span></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-292"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TcPluginM</span><span> </span><a href="GHC.TypeLits.Normalise.html#SimplifyResult"><span class="hs-identifier hs-type">SimplifyResult</span></a><span>
</span><a name="line-293"></a><span>    </span><a name="local-6989586621679091404"><a href="#local-6989586621679091404"><span class="hs-identifier">simples</span></a></a><span> </span><a name="local-6989586621679091407"><a href="#local-6989586621679091407"><span class="hs-identifier">_subst</span></a></a><span> </span><a name="local-6989586621679091408"><a href="#local-6989586621679091408"><span class="hs-identifier">evs</span></a></a><span> </span><a name="local-6989586621679091409"><a href="#local-6989586621679091409"><span class="hs-identifier">_leqsG</span></a></a><span> </span><a name="local-6989586621679091410"><a href="#local-6989586621679091410"><span class="hs-identifier">_xs</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.html#Simplified"><span class="hs-identifier hs-var">Simplified</span></a><span> </span><a href="#local-6989586621679091408"><span class="hs-identifier hs-var">evs</span></a><span class="hs-special">)</span><span>
</span><a name="line-294"></a><span>    </span><span class="hs-identifier">simples</span><span> </span><a name="local-6989586621679091411"><a href="#local-6989586621679091411"><span class="hs-identifier">subst</span></a></a><span> </span><a name="local-6989586621679091412"><a href="#local-6989586621679091412"><span class="hs-identifier">evs</span></a></a><span> </span><a name="local-6989586621679091413"><a href="#local-6989586621679091413"><span class="hs-identifier">leqsG</span></a></a><span> </span><a name="local-6989586621679091414"><a href="#local-6989586621679091414"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679091415"><a href="#local-6989586621679091415"><span class="hs-identifier">eq</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679091416"><a href="#local-6989586621679091416"><span class="hs-identifier">ct</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091417"><a href="#local-6989586621679091417"><span class="hs-identifier">u</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091418"><a href="#local-6989586621679091418"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><a name="local-6989586621679091419"><a href="#local-6989586621679091419"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679091420"><a href="#local-6989586621679091420"><span class="hs-identifier">eqs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-295"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679091421"><a href="#local-6989586621679091421"><span class="hs-identifier">u'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.TypeLits.Normalise.Unify.html#substsSOP"><span class="hs-identifier hs-var">substsSOP</span></a><span> </span><a href="#local-6989586621679091411"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679091417"><span class="hs-identifier hs-var">u</span></a><span>
</span><a name="line-296"></a><span>          </span><a name="local-6989586621679091422"><a href="#local-6989586621679091422"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.TypeLits.Normalise.Unify.html#substsSOP"><span class="hs-identifier hs-var">substsSOP</span></a><span> </span><a href="#local-6989586621679091411"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679091418"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-297"></a><span>      </span><a name="local-6989586621679091423"><a href="#local-6989586621679091423"><span class="hs-identifier">ur</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="GHC.TypeLits.Normalise.Unify.html#unifyNats"><span class="hs-identifier hs-var">unifyNats</span></a><span> </span><a href="#local-6989586621679091416"><span class="hs-identifier hs-var">ct</span></a><span> </span><a href="#local-6989586621679091421"><span class="hs-identifier hs-var">u'</span></a><span> </span><a href="#local-6989586621679091422"><span class="hs-identifier hs-var">v'</span></a><span>
</span><a name="line-298"></a><span>      </span><span class="hs-identifier hs-var">tcPluginTrace</span><span> </span><span class="hs-string">&quot;unifyNats result&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><a href="#local-6989586621679091423"><span class="hs-identifier hs-var">ur</span></a><span class="hs-special">)</span><span>
</span><a name="line-299"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679091423"><span class="hs-identifier hs-var">ur</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-300"></a><span>        </span><a href="GHC.TypeLits.Normalise.Unify.html#Win"><span class="hs-identifier hs-var">Win</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-301"></a><span>          </span><a name="local-6989586621679091424"><a href="#local-6989586621679091424"><span class="hs-identifier">evs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="#local-6989586621679091412"><span class="hs-identifier hs-var">evs</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><a href="#local-6989586621679091412"><span class="hs-identifier hs-var">evs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="GHC.TypeLits.Normalise.html#evMagic"><span class="hs-identifier hs-var">evMagic</span></a><span> </span><a href="#local-6989586621679091416"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091403"><span class="hs-identifier hs-var">subToPred</span></a><span> </span><a href="#local-6989586621679091419"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-302"></a><span>          </span><a href="#local-6989586621679091404"><span class="hs-identifier hs-var">simples</span></a><span> </span><a href="#local-6989586621679091411"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679091424"><span class="hs-identifier hs-var">evs'</span></a><span> </span><a href="#local-6989586621679091413"><span class="hs-identifier hs-var">leqsG</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091414"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679091420"><span class="hs-identifier hs-var">eqs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-303"></a><span>        </span><a href="GHC.TypeLits.Normalise.Unify.html#Lose"><span class="hs-identifier hs-var">Lose</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.html#Impossible"><span class="hs-identifier hs-var">Impossible</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679091415"><span class="hs-identifier hs-var">eq</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-304"></a><span>        </span><a href="GHC.TypeLits.Normalise.Unify.html#Draw"><span class="hs-identifier hs-var">Draw</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679091404"><span class="hs-identifier hs-var">simples</span></a><span> </span><a href="#local-6989586621679091411"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679091412"><span class="hs-identifier hs-var">evs</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091415"><span class="hs-identifier hs-var">eq</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679091414"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679091420"><span class="hs-identifier hs-var">eqs'</span></a><span>
</span><a name="line-305"></a><span>        </span><a href="GHC.TypeLits.Normalise.Unify.html#Draw"><span class="hs-identifier hs-var">Draw</span></a><span> </span><a name="local-6989586621679091425"><a href="#local-6989586621679091425"><span class="hs-identifier">subst'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-306"></a><span>          </span><a name="local-6989586621679091426"><a href="#local-6989586621679091426"><span class="hs-identifier">evM</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="GHC.TypeLits.Normalise.html#evMagic"><span class="hs-identifier hs-var">evMagic</span></a><span> </span><a href="#local-6989586621679091416"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="GHC.TypeLits.Normalise.html#unifyItemToPredType"><span class="hs-identifier hs-var">unifyItemToPredType</span></a><span> </span><a href="#local-6989586621679091425"><span class="hs-identifier hs-var">subst'</span></a><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-307"></a><span>                             </span><a href="#local-6989586621679091403"><span class="hs-identifier hs-var">subToPred</span></a><span> </span><a href="#local-6989586621679091419"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-308"></a><span>          </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679091427"><a href="#local-6989586621679091427"><span class="hs-identifier">leqsG'</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isGiven</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ctEvidence</span><span> </span><a href="#local-6989586621679091416"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679091405"><span class="hs-identifier hs-var">eqToLeq</span></a><span> </span><a href="#local-6989586621679091421"><span class="hs-identifier hs-var">u'</span></a><span> </span><a href="#local-6989586621679091422"><span class="hs-identifier hs-var">v'</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679091413"><span class="hs-identifier hs-var">leqsG</span></a><span>
</span><a name="line-309"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679091413"><span class="hs-identifier hs-var">leqsG</span></a><span>
</span><a name="line-310"></a><span>          </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679091426"><span class="hs-identifier hs-var">evM</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-311"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679091404"><span class="hs-identifier hs-var">simples</span></a><span> </span><a href="#local-6989586621679091411"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679091412"><span class="hs-identifier hs-var">evs</span></a><span> </span><a href="#local-6989586621679091427"><span class="hs-identifier hs-var">leqsG'</span></a><span> </span><a href="#local-6989586621679091414"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679091420"><span class="hs-identifier hs-var">eqs'</span></a><span>
</span><a name="line-312"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679091428"><a href="#local-6989586621679091428"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-313"></a><span>              </span><a href="#local-6989586621679091404"><span class="hs-identifier hs-var">simples</span></a><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.Unify.html#substsSubst"><span class="hs-identifier hs-var">substsSubst</span></a><span> </span><a href="#local-6989586621679091425"><span class="hs-identifier hs-var">subst'</span></a><span> </span><a href="#local-6989586621679091411"><span class="hs-identifier hs-var">subst</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679091425"><span class="hs-identifier hs-var">subst'</span></a><span class="hs-special">)</span><span>
</span><a name="line-314"></a><span>                      </span><span class="hs-special">(</span><a href="#local-6989586621679091428"><span class="hs-identifier hs-var">ev</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679091412"><span class="hs-identifier hs-var">evs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679091427"><span class="hs-identifier hs-var">leqsG'</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091414"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679091420"><span class="hs-identifier hs-var">eqs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-315"></a><span>    </span><span class="hs-identifier">simples</span><span> </span><a name="local-6989586621679091429"><a href="#local-6989586621679091429"><span class="hs-identifier">subst</span></a></a><span> </span><a name="local-6989586621679091430"><a href="#local-6989586621679091430"><span class="hs-identifier">evs</span></a></a><span> </span><a name="local-6989586621679091431"><a href="#local-6989586621679091431"><span class="hs-identifier">leqsG</span></a></a><span> </span><a name="local-6989586621679091432"><a href="#local-6989586621679091432"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679091433"><a href="#local-6989586621679091433"><span class="hs-identifier">eq</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679091434"><a href="#local-6989586621679091434"><span class="hs-identifier">ct</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091435"><a href="#local-6989586621679091435"><span class="hs-identifier">u</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679091436"><a href="#local-6989586621679091436"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091437"><a href="#local-6989586621679091437"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091438"><a href="#local-6989586621679091438"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><a name="local-6989586621679091439"><a href="#local-6989586621679091439"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679091440"><a href="#local-6989586621679091440"><span class="hs-identifier">eqs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-316"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679091441"><a href="#local-6989586621679091441"><span class="hs-identifier">u'</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="GHC.TypeLits.Normalise.Unify.html#substsSOP"><span class="hs-identifier hs-var">substsSOP</span></a><span> </span><a href="#local-6989586621679091429"><span class="hs-identifier hs-var">subst</span></a><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.Unify.html#subtractIneq"><span class="hs-identifier hs-var">subtractIneq</span></a><span> </span><a href="#local-6989586621679091435"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">)</span><span>
</span><a name="line-317"></a><span>          </span><a name="local-6989586621679091442"><a href="#local-6989586621679091442"><span class="hs-identifier">x'</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="GHC.TypeLits.Normalise.Unify.html#substsSOP"><span class="hs-identifier hs-var">substsSOP</span></a><span> </span><a href="#local-6989586621679091429"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679091436"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-318"></a><span>          </span><a name="local-6989586621679091443"><a href="#local-6989586621679091443"><span class="hs-identifier">y'</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="GHC.TypeLits.Normalise.Unify.html#substsSOP"><span class="hs-identifier hs-var">substsSOP</span></a><span> </span><a href="#local-6989586621679091429"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679091437"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-319"></a><span>          </span><a name="local-6989586621679091444"><a href="#local-6989586621679091444"><span class="hs-identifier">leqsG'</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isGiven</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ctEvidence</span><span> </span><a href="#local-6989586621679091434"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091442"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">,</span><a href="#local-6989586621679091443"><span class="hs-identifier hs-var">y'</span></a><span class="hs-special">,</span><a href="#local-6989586621679091438"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679091431"><span class="hs-identifier hs-var">leqsG</span></a><span>
</span><a name="line-320"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679091431"><span class="hs-identifier hs-var">leqsG</span></a><span>
</span><a name="line-321"></a><span>          </span><a name="local-6989586621679091445"><a href="#local-6989586621679091445"><span class="hs-identifier">ineqs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679091431"><span class="hs-identifier hs-var">leqsG</span></a><span>
</span><a name="line-322"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091406"><span class="hs-identifier hs-var">substLeq</span></a><span> </span><a href="#local-6989586621679091429"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679091431"><span class="hs-identifier hs-var">leqsG</span></a><span>
</span><a name="line-323"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">rights</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679091401"><span class="hs-identifier hs-var">eqsG</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-324"></a><span>                         </span><span class="hs-special">]</span><span>
</span><a name="line-325"></a><span>      </span><span class="hs-identifier hs-var">tcPluginTrace</span><span> </span><span class="hs-string">&quot;unifyNats(ineq) results&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ppr</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091434"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">,</span><a href="#local-6989586621679091435"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><a href="#local-6989586621679091441"><span class="hs-identifier hs-var">u'</span></a><span class="hs-special">,</span><a href="#local-6989586621679091445"><span class="hs-identifier hs-var">ineqs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-326"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="GHC.TypeLits.Normalise.Unify.html#isNatural"><span class="hs-identifier hs-var">isNatural</span></a><span> </span><a href="#local-6989586621679091441"><span class="hs-identifier hs-var">u'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-327"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-328"></a><span>          </span><a name="local-6989586621679091446"><a href="#local-6989586621679091446"><span class="hs-identifier">evs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="#local-6989586621679091430"><span class="hs-identifier hs-var">evs</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><a href="#local-6989586621679091430"><span class="hs-identifier hs-var">evs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="GHC.TypeLits.Normalise.html#evMagic"><span class="hs-identifier hs-var">evMagic</span></a><span> </span><a href="#local-6989586621679091434"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091403"><span class="hs-identifier hs-var">subToPred</span></a><span> </span><a href="#local-6989586621679091439"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-329"></a><span>          </span><a href="#local-6989586621679091404"><span class="hs-identifier hs-var">simples</span></a><span> </span><a href="#local-6989586621679091429"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679091446"><span class="hs-identifier hs-var">evs'</span></a><span> </span><a href="#local-6989586621679091444"><span class="hs-identifier hs-var">leqsG'</span></a><span> </span><a href="#local-6989586621679091432"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679091440"><span class="hs-identifier hs-var">eqs'</span></a><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.html#Impossible"><span class="hs-identifier hs-var">Impossible</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679091433"><span class="hs-identifier hs-var">eq</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-332"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-333"></a><span>          </span><span class="hs-comment">-- This inequality is either a given constraint, or it is a wanted</span><span>
</span><a name="line-334"></a><span>          </span><span class="hs-comment">-- constraint, which in normal form is equal to another given</span><span>
</span><a name="line-335"></a><span>          </span><span class="hs-comment">-- constraint, hence it can be solved.</span><span>
</span><a name="line-336"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">or</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapMaybe</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.Unify.html#solveIneq"><span class="hs-identifier hs-var">solveIneq</span></a><span> </span><span class="hs-number">5</span><span> </span><a href="#local-6989586621679091435"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679091445"><span class="hs-identifier hs-var">ineqs</span></a><span class="hs-special">)</span><span>
</span><a name="line-337"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-338"></a><span>            </span><a name="local-6989586621679091447"><a href="#local-6989586621679091447"><span class="hs-identifier">evs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="#local-6989586621679091430"><span class="hs-identifier hs-var">evs</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><a href="#local-6989586621679091430"><span class="hs-identifier hs-var">evs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="GHC.TypeLits.Normalise.html#evMagic"><span class="hs-identifier hs-var">evMagic</span></a><span> </span><a href="#local-6989586621679091434"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091403"><span class="hs-identifier hs-var">subToPred</span></a><span> </span><a href="#local-6989586621679091439"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-339"></a><span>            </span><a href="#local-6989586621679091404"><span class="hs-identifier hs-var">simples</span></a><span> </span><a href="#local-6989586621679091429"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679091447"><span class="hs-identifier hs-var">evs'</span></a><span> </span><a href="#local-6989586621679091444"><span class="hs-identifier hs-var">leqsG'</span></a><span> </span><a href="#local-6989586621679091432"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679091440"><span class="hs-identifier hs-var">eqs'</span></a><span>
</span><a name="line-340"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-341"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679091404"><span class="hs-identifier hs-var">simples</span></a><span> </span><a href="#local-6989586621679091429"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679091430"><span class="hs-identifier hs-var">evs</span></a><span> </span><a href="#local-6989586621679091431"><span class="hs-identifier hs-var">leqsG</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091433"><span class="hs-identifier hs-var">eq</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679091432"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679091440"><span class="hs-identifier hs-var">eqs'</span></a><span>
</span><a name="line-342"></a><span>
</span><a name="line-343"></a><span>    </span><a name="local-6989586621679091405"><a href="#local-6989586621679091405"><span class="hs-identifier">eqToLeq</span></a></a><span> </span><a name="local-6989586621679091448"><a href="#local-6989586621679091448"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679091449"><a href="#local-6989586621679091449"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679091448"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679091449"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="#local-6989586621679091449"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679091448"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-344"></a><span>    </span><a name="local-6989586621679091406"><a href="#local-6989586621679091406"><span class="hs-identifier">substLeq</span></a></a><span> </span><a name="local-6989586621679091450"><a href="#local-6989586621679091450"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679091451"><a href="#local-6989586621679091451"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091452"><a href="#local-6989586621679091452"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091453"><a href="#local-6989586621679091453"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.Unify.html#substsSOP"><span class="hs-identifier hs-var">substsSOP</span></a><span> </span><a href="#local-6989586621679091450"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679091451"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="GHC.TypeLits.Normalise.Unify.html#substsSOP"><span class="hs-identifier hs-var">substsSOP</span></a><span> </span><a href="#local-6989586621679091450"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679091452"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679091453"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-comment">-- Extract the Nat equality constraints</span><span>
</span><a name="line-347"></a><span class="hs-identifier">toNatEquality</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ct</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="GHC.TypeLits.Normalise.html#NatEquality"><span class="hs-identifier hs-type">NatEquality</span></a><span> </span><a href="GHC.TypeLits.Normalise.html#NatInEquality"><span class="hs-identifier hs-type">NatInEquality</span></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-348"></a><a name="toNatEquality"><a href="GHC.TypeLits.Normalise.html#toNatEquality"><span class="hs-identifier">toNatEquality</span></a></a><span> </span><a name="local-6989586621679091455"><a href="#local-6989586621679091455"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">classifyPredType</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ctEvPred</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ctEvidence</span><span> </span><a href="#local-6989586621679091455"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-349"></a><span>    </span><span class="hs-identifier hs-var">EqPred</span><span> </span><span class="hs-identifier hs-var">NomEq</span><span> </span><a name="local-6989586621679091481"><a href="#local-6989586621679091481"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679091482"><a href="#local-6989586621679091482"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-350"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679091456"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679091481"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679091482"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-351"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-352"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-353"></a><span>    </span><a name="local-6989586621679091456"><a href="#local-6989586621679091456"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TyConApp</span><span> </span><a name="local-6989586621679091458"><a href="#local-6989586621679091458"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679091459"><a href="#local-6989586621679091459"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TyConApp</span><span> </span><a name="local-6989586621679091460"><a href="#local-6989586621679091460"><span class="hs-identifier">tc'</span></a></a><span> </span><a name="local-6989586621679091461"><a href="#local-6989586621679091461"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-354"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679091458"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679091460"><span class="hs-identifier hs-var">tc'</span></a><span>
</span><a name="line-355"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679091458"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">,</span><a href="#local-6989586621679091460"><span class="hs-identifier hs-var">tc'</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">intersect</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">typeNatAddTyCon</span><span class="hs-special">,</span><span class="hs-identifier hs-var">typeNatSubTyCon</span><span>
</span><a name="line-356"></a><span>                                   </span><span class="hs-special">,</span><span class="hs-identifier hs-var">typeNatMulTyCon</span><span class="hs-special">,</span><span class="hs-identifier hs-var">typeNatExpTyCon</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-357"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><span class="hs-identifier hs-var">eqType</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679091459"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679091461"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-358"></a><span>          </span><span class="hs-special">[</span><span class="hs-special">(</span><a name="local-6989586621679091462"><a href="#local-6989586621679091462"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091463"><a href="#local-6989586621679091463"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-359"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679091457"><span class="hs-identifier hs-var">isNatKind</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeKind</span><span> </span><a href="#local-6989586621679091462"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-360"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679091457"><span class="hs-identifier hs-var">isNatKind</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeKind</span><span> </span><a href="#local-6989586621679091463"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-361"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679091464"><a href="#local-6989586621679091464"><span class="hs-identifier">x'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091465"><a href="#local-6989586621679091465"><span class="hs-identifier">k1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runWriter</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.Unify.html#normaliseNat"><span class="hs-identifier hs-var">normaliseNat</span></a><span> </span><a href="#local-6989586621679091462"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-362"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679091466"><a href="#local-6989586621679091466"><span class="hs-identifier">y'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091467"><a href="#local-6989586621679091467"><span class="hs-identifier">k2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runWriter</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.Unify.html#normaliseNat"><span class="hs-identifier hs-var">normaliseNat</span></a><span> </span><a href="#local-6989586621679091463"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-363"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091455"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679091464"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679091466"><span class="hs-identifier hs-var">y'</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679091465"><span class="hs-identifier hs-var">k1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679091467"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">)</span><span>
</span><a name="line-364"></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-365"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679091458"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">typeNatLeqTyCon</span><span>
</span><a name="line-366"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679091468"><a href="#local-6989586621679091468"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091469"><a href="#local-6989586621679091469"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679091459"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-367"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679091470"><a href="#local-6989586621679091470"><span class="hs-identifier">x'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091471"><a href="#local-6989586621679091471"><span class="hs-identifier">k1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runWriter</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.Unify.html#normaliseNat"><span class="hs-identifier hs-var">normaliseNat</span></a><span> </span><a href="#local-6989586621679091468"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-368"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679091472"><a href="#local-6989586621679091472"><span class="hs-identifier">y'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091473"><a href="#local-6989586621679091473"><span class="hs-identifier">k2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runWriter</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.Unify.html#normaliseNat"><span class="hs-identifier hs-var">normaliseNat</span></a><span> </span><a href="#local-6989586621679091469"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-369"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679091474"><a href="#local-6989586621679091474"><span class="hs-identifier">ks</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679091471"><span class="hs-identifier hs-var">k1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679091473"><span class="hs-identifier hs-var">k2</span></a><span>
</span><a name="line-370"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679091460"><span class="hs-identifier hs-var">tc'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-371"></a><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679091460"><span class="hs-identifier hs-var">tc'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">promotedTrueDataCon</span><span>
</span><a name="line-372"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091455"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091470"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679091472"><span class="hs-identifier hs-var">y'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679091474"><span class="hs-identifier hs-var">ks</span></a><span class="hs-special">)</span><span>
</span><a name="line-373"></a><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679091460"><span class="hs-identifier hs-var">tc'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">promotedFalseDataCon</span><span>
</span><a name="line-374"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091455"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091470"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679091472"><span class="hs-identifier hs-var">y'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679091474"><span class="hs-identifier hs-var">ks</span></a><span class="hs-special">)</span><span>
</span><a name="line-375"></a><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679091475"><a href="#local-6989586621679091475"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679091476"><a href="#local-6989586621679091476"><span class="hs-identifier">y</span></a></a><span>
</span><a name="line-378"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679091457"><span class="hs-identifier hs-var">isNatKind</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeKind</span><span> </span><a href="#local-6989586621679091475"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-379"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679091457"><span class="hs-identifier hs-var">isNatKind</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeKind</span><span> </span><a href="#local-6989586621679091476"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-380"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679091477"><a href="#local-6989586621679091477"><span class="hs-identifier">x'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091478"><a href="#local-6989586621679091478"><span class="hs-identifier">k1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runWriter</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.Unify.html#normaliseNat"><span class="hs-identifier hs-var">normaliseNat</span></a><span> </span><a href="#local-6989586621679091475"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-381"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679091479"><a href="#local-6989586621679091479"><span class="hs-identifier">y'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679091480"><a href="#local-6989586621679091480"><span class="hs-identifier">k2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runWriter</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.Unify.html#normaliseNat"><span class="hs-identifier hs-var">normaliseNat</span></a><span> </span><a href="#local-6989586621679091476"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-382"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679091455"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">,</span><a href="#local-6989586621679091477"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">,</span><a href="#local-6989586621679091479"><span class="hs-identifier hs-var">y'</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679091478"><span class="hs-identifier hs-var">k1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679091480"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">)</span><span>
</span><a name="line-383"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-384"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-385"></a><span>
</span><a name="line-386"></a><span>    </span><span class="hs-identifier">isNatKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kind</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-387"></a><span>    </span><a name="local-6989586621679091457"><a href="#local-6989586621679091457"><span class="hs-identifier">isNatKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">eqType</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">typeNatKind</span><span class="hs-special">)</span><span>
</span><a name="line-388"></a><span>
</span><a name="line-389"></a><span class="hs-identifier">unifyItemToPredType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.TypeLits.Normalise.Unify.html#CoreUnify"><span class="hs-identifier hs-type">CoreUnify</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PredType</span><span>
</span><a name="line-390"></a><a name="unifyItemToPredType"><a href="GHC.TypeLits.Normalise.html#unifyItemToPredType"><span class="hs-identifier">unifyItemToPredType</span></a></a><span> </span><a name="local-6989586621679091483"><a href="#local-6989586621679091483"><span class="hs-identifier">ui</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-391"></a><span>    </span><span class="hs-identifier hs-var">mkPrimEqPred</span><span> </span><a href="#local-6989586621679091484"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-6989586621679091485"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-392"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-393"></a><span>    </span><a name="local-6989586621679091484"><a href="#local-6989586621679091484"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679091483"><span class="hs-identifier hs-var">ui</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-394"></a><span>            </span><a href="GHC.TypeLits.Normalise.Unify.html#SubstItem"><span class="hs-identifier hs-var">SubstItem</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mkTyVarTy</span><span> </span><a href="#local-6989586621679091486"><span class="hs-identifier hs-var">siVar</span></a><span>
</span><a name="line-395"></a><span>            </span><a href="GHC.TypeLits.Normalise.Unify.html#UnifyItem"><span class="hs-identifier hs-var">UnifyItem</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.TypeLits.Normalise.Unify.html#reifySOP"><span class="hs-identifier hs-var">reifySOP</span></a><span> </span><a href="#local-6989586621679091488"><span class="hs-identifier hs-var">siLHS</span></a><span>
</span><a name="line-396"></a><span>    </span><a name="local-6989586621679091485"><a href="#local-6989586621679091485"><span class="hs-identifier">ty2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679091483"><span class="hs-identifier hs-var">ui</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-397"></a><span>            </span><a href="GHC.TypeLits.Normalise.Unify.html#SubstItem"><span class="hs-identifier hs-var">SubstItem</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.TypeLits.Normalise.Unify.html#reifySOP"><span class="hs-identifier hs-var">reifySOP</span></a><span> </span><a href="#local-6989586621679091491"><span class="hs-identifier hs-var">siSOP</span></a><span>
</span><a name="line-398"></a><span>            </span><a href="GHC.TypeLits.Normalise.Unify.html#UnifyItem"><span class="hs-identifier hs-var">UnifyItem</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.TypeLits.Normalise.Unify.html#reifySOP"><span class="hs-identifier hs-var">reifySOP</span></a><span> </span><a href="#local-6989586621679091493"><span class="hs-identifier hs-var">siRHS</span></a><span>
</span><a name="line-399"></a><span>
</span><a name="line-400"></a><span class="hs-identifier">evMagic</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ct</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">PredType</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TcPluginM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-type">EvTerm</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ct</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Ct</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-401"></a><a name="evMagic"><a href="GHC.TypeLits.Normalise.html#evMagic"><span class="hs-identifier">evMagic</span></a></a><span> </span><a name="local-6989586621679091494"><a href="#local-6989586621679091494"><span class="hs-identifier">ct</span></a></a><span> </span><a name="local-6989586621679091495"><a href="#local-6989586621679091495"><span class="hs-identifier">preds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">classifyPredType</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ctEvPred</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ctEvidence</span><span> </span><a href="#local-6989586621679091494"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-402"></a><span>  </span><span class="hs-identifier hs-var">EqPred</span><span> </span><span class="hs-identifier hs-var">NomEq</span><span> </span><a name="local-6989586621679091496"><a href="#local-6989586621679091496"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679091497"><a href="#local-6989586621679091497"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-403"></a><span class="hs-cpp">#if MIN_VERSION_ghc(8,4,1)
</span><span>    </span><a name="local-6989586621679091498"><a href="#local-6989586621679091498"><span class="hs-identifier">holes</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">newCoercionHole</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><span class="hs-identifier hs-var">mkPrimEqPred</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">getEqPredTys</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679091495"><span class="hs-identifier hs-var">preds</span></a><span>
</span><a name="line-405"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-identifier">holes</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">replicateM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">preds</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">newCoercionHole</span><span>
</span><a name="line-407"></a><span class="hs-cpp">#endif
</span><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679091499"><a href="#local-6989586621679091499"><span class="hs-identifier">newWanted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><a href="GHC.TypeLits.Normalise.html#unifyItemToCt"><span class="hs-identifier hs-var">unifyItemToCt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ctLoc</span><span> </span><a href="#local-6989586621679091494"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679091495"><span class="hs-identifier hs-var">preds</span></a><span> </span><a href="#local-6989586621679091498"><span class="hs-identifier hs-var">holes</span></a><span>
</span><a name="line-409"></a><span>        </span><a name="local-6989586621679091500"><a href="#local-6989586621679091500"><span class="hs-identifier">ctEv</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkUnivCo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PluginProv</span><span> </span><span class="hs-string">&quot;ghc-typelits-natnormalise&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nominal</span><span> </span><a href="#local-6989586621679091496"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679091497"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-410"></a><span class="hs-cpp">#if MIN_VERSION_ghc(8,4,1)
</span><span>        </span><a name="local-6989586621679091501"><a href="#local-6989586621679091501"><span class="hs-identifier">holeEvs</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">mkHoleCo</span><span> </span><a href="#local-6989586621679091498"><span class="hs-identifier hs-var">holes</span></a><span>
</span><a name="line-412"></a><span class="hs-cpp">#else
</span><span>        </span><span class="hs-identifier">holeEvs</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">zipWith</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">h</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">uncurry</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkHoleCo</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-identifier">Nominal</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">getEqPredTys</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">holes</span><span> </span><span class="hs-identifier">preds</span><span>
</span><a name="line-414"></a><span class="hs-cpp">#endif
</span><span>        </span><a name="local-6989586621679091502"><a href="#local-6989586621679091502"><span class="hs-identifier">natReflCo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkNomReflCo</span><span> </span><span class="hs-identifier hs-var">typeNatKind</span><span>
</span><a name="line-416"></a><span>        </span><a name="local-6989586621679091503"><a href="#local-6989586621679091503"><span class="hs-identifier">natCoBndr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><a href="#local-6989586621679091502"><span class="hs-identifier hs-var">natReflCo</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">newFlexiTyVar</span><span> </span><span class="hs-identifier hs-var">typeNatKind</span><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>    </span><a name="local-6989586621679092053"><a href="#local-6989586621679092053"><span class="hs-identifier">forallEv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mkForAllCos</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicateM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679091495"><span class="hs-identifier hs-var">preds</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679091503"><span class="hs-identifier hs-var">natCoBndr</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679091500"><span class="hs-identifier hs-var">ctEv</span></a><span>
</span><a name="line-418"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679092054"><a href="#local-6989586621679092054"><span class="hs-identifier">finalEv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-identifier hs-var">mkInstCo</span><span> </span><a href="#local-6989586621679092053"><span class="hs-identifier hs-var">forallEv</span></a><span> </span><a href="#local-6989586621679091501"><span class="hs-identifier hs-var">holeEvs</span></a><span>
</span><a name="line-419"></a><span class="hs-cpp">#if MIN_VERSION_ghc(8,5,0)
</span><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">EvExpr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Coercion</span><span> </span><span class="hs-identifier">finalEv</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ct</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier">newWanted</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-421"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">EvCoercion</span><span> </span><a href="#local-6989586621679092054"><span class="hs-identifier hs-var">finalEv</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679091494"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679091499"><span class="hs-identifier hs-var">newWanted</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-423"></a><span class="hs-cpp">#endif
</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-425"></a><span>
</span><a name="line-426"></a><span class="hs-identifier">unifyItemToCt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CtLoc</span><span>
</span><a name="line-427"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PredType</span><span>
</span><a name="line-428"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CoercionHole</span><span>
</span><a name="line-429"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ct</span><span>
</span><a name="line-430"></a><a name="unifyItemToCt"><a href="GHC.TypeLits.Normalise.html#unifyItemToCt"><span class="hs-identifier">unifyItemToCt</span></a></a><span> </span><a name="local-6989586621679092055"><a href="#local-6989586621679092055"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621679092056"><a href="#local-6989586621679092056"><span class="hs-identifier">pred_type</span></a></a><span> </span><a name="local-6989586621679092057"><a href="#local-6989586621679092057"><span class="hs-identifier">hole</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-431"></a><span>  </span><span class="hs-identifier hs-var">mkNonCanonical</span><span>
</span><a name="line-432"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CtWanted</span><span>
</span><a name="line-433"></a><span>      </span><a href="#local-6989586621679092056"><span class="hs-identifier hs-var">pred_type</span></a><span>
</span><a name="line-434"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">HoleDest</span><span> </span><a href="#local-6989586621679092057"><span class="hs-identifier hs-var">hole</span></a><span class="hs-special">)</span><span>
</span><a name="line-435"></a><span class="hs-cpp">#if MIN_VERSION_ghc(8,2,0)
</span><span>      </span><span class="hs-identifier hs-var">WDeriv</span><span>
</span><a name="line-437"></a><span class="hs-cpp">#endif
</span><span>      </span><a href="#local-6989586621679092055"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-439"></a></pre></body></html>